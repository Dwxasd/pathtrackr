<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>pathtrackr by aharmer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">pathtrackr</h1>
      <h2 class="project-tagline">An R package for video tracking and analysing animal movement</h2>
      <a href="https://github.com/aharmer/pathtrackr" class="btn">View on GitHub</a>
      <a href="https://github.com/aharmer/pathtrackr/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/aharmer/pathtrackr/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="overview" class="anchor" href="#overview" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Overview</h2>

<p>Visualising and analysing animal movement patterns is essential to many behavioural studies. While commercial options exist for analysing animal movement via video, the cost of these is often prohibitive. To meet the need for an efficient and cost-effective video tracking and analysis tool, we have developed the 'pathtrackr' package. The 'pathtrackr' package allows for an automated and consolidated workflow, from video input to statistical output of an animal's movement. The tracking functions work across a variety of visual contexts, including heterogeneous backgrounds and variable lighting, and can deal with small amounts of localised background movement. We also include diagnostic tools in the package for troubleshooting. Future updates will include the ability to track multiple animals simultaneously, extending the functionality to track animal interactions.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<h4>
<a id="pathtrackr" class="anchor" href="#pathtrackr" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>pathtrackr</h4>

<p>You can install <em>pathtrackr</em> directly from within R using the <em>install_github()</em> function from the <em><a href="https://github.com/hadley/devtools#readme">devtools</a></em> package:</p>

<div class="highlight highlight-source-r"><pre>install_github(<span class="pl-s"><span class="pl-pds">"</span>aharmer/pathtrackr<span class="pl-pds">"</span></span>)</pre></div>

<p>Alternatively, you can manually download and install the source package from the <a href="https://aharmer.github.io/pathtrackr/">pathtrackr</a> webpage.</p>

<h4>
<a id="ffmpeg" class="anchor" href="#ffmpeg" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>FFmpeg</h4>

<p>The <em>pathtrackr</em> package includes functions for handling video files; <em>splitVideo()</em>, which compresses and splits a video into individual jpeg frames that are used by the tracking functions, and <em>makeVideo()</em>, which outputs an mp4 video file of the tracking behaviour performed by the tracking functions, along with summary plots for each frame. These functions require <a href="https://ffmpeg.org">FFmpeg</a> to be installed on your machine, which R calls via the <em>system()</em> function.</p>

<p>If you do not already have FFmpeg installed, these links provide excellent instructions:</p>

<p><a href="http://www.idiotinside.com/2016/05/01/ffmpeg-mac-os-x/">Install FFmpeg on Mac</a>
<a href="http://www.wikihow.com/Install-FFmpeg-on-Windows">Install FFmpeg on Windows</a></p>

<h2>
<a id="how-to-use-pathtrackr" class="anchor" href="#how-to-use-pathtrackr" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How to use pathtrackr</h2>

<p>Using <em>pathtrackr</em> is very straightforward. Below are simple steps to process and analsyse your animal movement videos.</p>

<h4>
<a id="1-extract-jpegs-from-video" class="anchor" href="#1-extract-jpegs-from-video" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. Extract jpegs from video</h4>

<div class="highlight highlight-source-r"><pre>splitVideo(<span class="pl-smi">filepath</span>, <span class="pl-smi">fps</span>, <span class="pl-v">xpix</span> <span class="pl-k">=</span> <span class="pl-c1">320</span>, <span class="pl-v">ypix</span> <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1</span>)</pre></div>

<p>Using the function <em>splitVideo</em>, specify the: * file path of your video * the number of frames per second to extract. If fps is equal to the recording frame rate, all frames will be extracted. For fast moving animals, it is recommended to use a higher frame rate * size (in pixels) of the extracted jpegs. The tracking functions here do not require high resolution imagery, so we recommend using the default values for faster processing time. A value of -1 for ypix will maintain the aspect ratio.</p>

<p>The still frames will be saved in a new directory with the same name as the video file.</p>

<h4>
<a id="2-track-your-animals-movement" class="anchor" href="#2-track-your-animals-movement" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. Track your animal's movement</h4>

<div class="highlight highlight-source-r"><pre>trackPath(<span class="pl-smi">dirpath</span>, <span class="pl-smi">xarena</span>, <span class="pl-smi">yarena</span>, <span class="pl-smi">fps</span>, <span class="pl-v">box</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>, <span class="pl-v">contrast</span> <span class="pl-k">=</span> <span class="pl-c1">0.5</span>)</pre></div>

<p>Next, use the <em>trackPath()</em> function and assign to a new object. Specify the directory containing your extracted jpegs, the dimensions of your arena in mm, and the frame rate at which you extracted still frames from the video. The function will work if these values are incorrectly specified, however, they are used in distance and velocity calculations later, so will return incorrect values.</p>

<p>After running the function, you will be prompted to define the animal in the first frame of the video. Click once to select one corner of the tracking box, and click once more to select the opposing corner.</p>

<p><img src="https://cloud.githubusercontent.com/assets/10540385/16355521/e27c4cd4-3b0c-11e6-9f2f-2e8f841ef308.jpg" alt="animal\_selection"></p>

<p>You will then be prompted to define the edges of the arena. Again, select the opposing corners on the image that mark the edges of the arena.</p>

<p><img src="https://cloud.githubusercontent.com/assets/10540385/16355522/e81f8f3e-3b0c-11e6-9c53-53bd9eba0b70.jpg" alt="bg\_selection"></p>

<p>The function will now begin tracking your animal across frames and return a list with a range of useful information, including a matrix of the xy co-ordinates of the animal in each frame, a matrix of movement data such as distances, velocities and bearings bewteen each frame, and some summary data. Each of these elements can be retrieved by referencing the appropriate element in the returned list.</p>

<h4>
<a id="3-make-some-pretty-plots" class="anchor" href="#3-make-some-pretty-plots" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. Make some pretty plots</h4>

<div class="highlight highlight-source-r"><pre>plotPath(<span class="pl-smi">path.list</span>)</pre></div>

<p>The <em>plotPath()</em> function will plot the animal's path across the arena with density clouds representing the relative time spent in a given location. The only input required is the names list generated previously.</p>

<p><img src="https://cloud.githubusercontent.com/assets/10540385/16355859/837b3d7e-3b18-11e6-9884-9e042ed8f0ce.jpg" alt="plotpath\_example"></p>

<hr>

<div class="highlight highlight-source-r"><pre> plotSummary(<span class="pl-smi">path.list</span>)</pre></div>

<p>The <em>plotSummary()</em> function returns a four-paneled plot summariing the the animal's path, i.e. cumulative distance and velocity over time, and absolute and relative bearings across frames.</p>

<p><img src="https://cloud.githubusercontent.com/assets/10540385/16355860/8f92255a-3b18-11e6-8b48-d8961536dad6.jpg" alt="plotsummary\_example"></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/aharmer/pathtrackr">pathtrackr</a> is maintained by <a href="https://github.com/aharmer">aharmer</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
